rules:
  - id: CVE-2025-23016
    options:
      symbolic_propagation: true
    metadata:
      author: c0ss4ck9989@gmail.com
      references:
        - https://github.com/FastCGI-Archives/fcgi2/issues/67
      confidence: MEDIUM
    message: >-
      FastCGI fcgi2 (aka fcgi) 2.x through 2.4.4 has an integer overflow (and resultant heap-based buffer overflow) via crafted nameLen or valueLen values in data to the IPC socket. This occurs in ReadParams in fcgiapp.c.
    severity: ERROR
    languages:
      - c
      - cpp
    patterns:
      - pattern: |
          while( ... ) {
            ...
            $NAME_LEN = $GET_CHR(...);
            ...
            if ( ... ) {
              if ( $GET_STR(...) != 3 ) {
                ...
              }
              $NAME_LEN = ...;
            }
            ...
          }
      - pattern-not: |
          while( ... ) {
            ...
            $NAME_LEN = $GET_CHR(...);
            ...
            if ( ... ) {
              if ( $GET_STR(...) != 3 ) {
                ...
              }
              $NAME_LEN = ...;
              if (<... $NAME_LEN ...>) {
                ...
              }
              ...
            }
            ...
          }
      - focus-metavariable: $NAME_LEN