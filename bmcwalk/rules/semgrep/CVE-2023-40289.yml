rules:
  - id: CVE-2023-40289
    metadata:
      author: c0ss4ck9989@gmail.com
      references:
        - https://www.supermicro.org.cn/en/support/security_BMC_IPMI_Oct_2023
      confidence: HIGH
    message: >-
      An unvalidated input value could allow the attacker to perform command injection.
    severity: ERROR
    languages:
      - c
      - cpp
    patterns:
      - pattern: |
          $VAR = j_cgiGetPostVariable("mail", $LEN);
          ...
          j_set_config_alert_email(..., $VAR);
      - pattern-not: |
          $VAR = j_cgiGetPostVariable("mail");
          ...
          j_xstrcpy($OTHER, $VAR);
          ...
          j_EscapeShellCmd($OTHER);
