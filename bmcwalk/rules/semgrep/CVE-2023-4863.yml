rules:
  - id: CVE-2023-4863
    metadata:
      author: c0ss4ck9989@gmail.com
      references:
        - https://github.com/advisories/GHSA-j7hp-h8jx-5ppr
      confidence: HIGH
    message: >-
      Heap buffer overflow in libwebp in Google Chrome prior to 116.0.5845.187 
      and libwebp 1.3.2 allowed a remote attacker to perform an out of bounds memory write 
      via a crafted HTML page. (Chromium security severity: Critical)
    severity: ERROR
    languages:
      - c
      - cpp
    pattern-either:
      - pattern: |
          $R0 = $NEW($N1 * $N2, ...);
          ...
          $NEW2(...);
          ...
          if (!$R0 || !$V1 || !$V2 ) $FAIL;
          ...
          $FREE(...);
          $FREE(...);
          $FREE2(...);
          $FREE3(...);
          $FREE3(...);
      - pattern: |
          $R0 = $NEW($N1 * $N2, ...);
          ...
          $NEW2(...);
          ...
          if (!$R0 || !$V1 || !$V2 ) $FAIL;
          ...
          $FREE(...);
          $FREE(...);
          if ($V3)
          {
            $FREE(...);
            $FREE(...);
            ...
          }
      - pattern: |
          $R0 = $NEW($N1 * $N2, ...);
          ...
          $NEW2(...);
          ...
          if (!$V1 || !$R0 || !$V2 ) $FAIL;
          ...
          $FREE(...);
          $FREE(...);
          $FREE2(...);
          $FREE3(...);
          $FREE3(...);
      - pattern: |
          $R0 = $NEW($N1 * $N2, ...);
          ...
          $NEW2(...);
          ...
          if (!$V1 || !$R0 || !$V2 ) $FAIL;
          ...
          $FREE(...);
          $FREE(...);
          if ($V3)
          {
            $FREE(...);
            $FREE(...);
            ...
          }
      - pattern: |
          $R0 = $NEW($N1 * $N2, ...);
          ...
          $NEW2(...);
          ...
          if (!$V1 || !$V2 || !$R0 ) $FAIL;
          ...
          $FREE(...);
          $FREE(...);
          $FREE2(...);
          $FREE3(...);
          $FREE3(...);
      - pattern: |
          $R0 = $NEW($N1 * $N2, ...);
          ...
          $NEW2(...);
          ...
          if (!$V1 || !$V2 || !$R0 ) $FAIL;
          ...
          $FREE(...);
          $FREE(...);
          if ($V3)
          {
            $FREE(...);
            $FREE(...);
            ...
          }