int __fastcall ProcessDownloadOpCodeReqData(int a1, int a2, _BYTE *a3, char *a4, int a5)
{
  int (__fastcall *v9)(int, int, _BYTE *, char *, int); // r4
  int v10; // r0
  int FilePath; // r4
  _DWORD *v12; // r5
  int v13; // t1
  int v14; // r1
  int v15; // r2
  int v16; // r3
  int (__fastcall *v17)(int, int, int *, char *); // r4
  int result; // r0
  _DWORD *v19; // r5
  int v20; // t1
  int v21; // r3
  int v22; // r1
  int v23; // r2
  int (__fastcall *v24)(int, int, int *, char *); // r4
  int v25; // r1
  unsigned int v26; // r3
  _DWORD *v27; // r5
  int v28; // t1
  bool v29; // zf
  int v30; // r1
  int v31; // r2
  int v32; // r3
  int v33; // [sp+8h] [bp-4B0h] BYREF
  int v34; // [sp+Ch] [bp-4ACh]
  int v35; // [sp+10h] [bp-4A8h]
  int v36; // [sp+14h] [bp-4A4h]
  int v37; // [sp+18h] [bp-4A0h]
  char s[132]; // [sp+1Ch] [bp-49Ch] BYREF
  char v39[1048]; // [sp+A0h] [bp-418h] BYREF

  v34 = 0;
  v33 = 0;
  v35 = 0;
  v36 = 0;
  v37 = 0;
  memset(s, 0, 0x81u);
  memset(v39, 0, 0x400u);
  v9 = (int (__fastcall *)(int, int, _BYTE *, char *, int))g_PDKHandle[273];
  if ( !v9 )
    goto LABEL_4;
  v10 = v9(a1, a2, a3, a4, a5);
  FilePath = v10;
  if ( !v10 )
    return 0;
  if ( v10 <= 0 )
  {
LABEL_4:
    switch ( *(_BYTE *)a1 )
    {
      case 0:
        if ( (unsigned int)(a2 - 8) > 0x80 )
          goto LABEL_13;
        memcpy(s, (const void *)(a1 + 8), a2 - 8);
        s[128] = 0;
        if ( j_IsValidUserDir(s) )
        {
          FilePath = GetFilePath(0, v39);
          if ( FilePath )
          {
LABEL_43:
            *a3 = -127;
            return 1;
          }
          else
          {
            snprintf(a4, 0x100u, "%s/%s", v39, s);
          }
        }
        else
        {
          IDBG_LINUXAPP_DbgOut(130, "[%s:%d]Invalid DIRName\n", "AMI/AMIDataTransfer.c", 280);
          *a3 = -127;
          return 1;
        }
        return FilePath;
      case 1:
        if ( g_corefeatures[204] != 1 )
          goto LABEL_15;
        FilePath = GetFilePath(1, v39);
        if ( FilePath )
          goto LABEL_43;
        snprintf(a4, 0x100u, "%s/bundle.bdl", v39);
        return FilePath;
      case 2:
        FilePath = g_corefeatures[204];
        if ( FilePath != 1 )
          goto LABEL_15;
        if ( a2 != 29 )
          goto LABEL_13;
        v26 = *(unsigned __int8 *)(a1 + 8);
        if ( v26 > 1 )
        {
          *a3 = -52;
          return FilePath;
        }
        v28 = *(_DWORD *)(a1 + 9);
        v27 = (_DWORD *)(a1 + 9);
        v29 = v26 == 0;
        v30 = v27[1];
        v31 = v27[2];
        v32 = v27[3];
        v33 = v28;
        v34 = v30;
        v35 = v31;
        v36 = v32;
        v37 = v27[4];
        if ( !v29 )
          return 0;
        if ( !pCUILHandle )
        {
          v21 = 333;
          goto LABEL_48;
        }
        v24 = (int (__fastcall *)(int, int, int *, char *))dlsym(pCUILHandle, "CUIL_GetImageName");
        if ( !v24 )
          goto LABEL_38;
        v25 = 2;
LABEL_37:
        if ( v24(v25, v25, &v33, a4) )
          goto LABEL_38;
        return 0;
      case 3:
        if ( g_corefeatures[204] != 1 )
          goto LABEL_15;
        FilePath = GetFilePath(3, v39);
        if ( FilePath )
          goto LABEL_43;
        snprintf(a4, 0x100u, "%s/rom.ima", v39);
        return FilePath;
      case 6:
        FilePath = g_corefeatures[204];
        if ( FilePath != 1 )
          goto LABEL_15;
        if ( a2 != 28 )
          goto LABEL_13;
        v20 = *(_DWORD *)(a1 + 8);
        v19 = (_DWORD *)(a1 + 8);
        v21 = v19[3];
        v22 = v19[1];
        v23 = v19[2];
        v33 = v20;
        v34 = v22;
        v35 = v23;
        v36 = v21;
        if ( !pCUILHandle )
          v21 = 387;
        v37 = v19[4];
        if ( !pCUILHandle )
          goto LABEL_48;
        v24 = (int (__fastcall *)(int, int, int *, char *))dlsym(pCUILHandle, "CUIL_GetImageName");
        if ( !v24 )
          goto LABEL_38;
        v25 = 6;
        goto LABEL_37;
      case 7:
        FilePath = g_corefeatures[204];
        if ( FilePath != 1 )
        {
LABEL_15:
          result = 1;
          *a3 = 0x80;
          return result;
        }
        if ( a2 != 28 )
        {
LABEL_13:
          result = 1;
          *a3 = -57;
          return result;
        }
        v13 = *(_DWORD *)(a1 + 8);
        v12 = (_DWORD *)(a1 + 8);
        v14 = v12[1];
        v15 = v12[2];
        v16 = v12[3];
        v33 = v13;
        v34 = v14;
        v35 = v15;
        v36 = v16;
        v37 = v12[4];
        if ( !pCUILHandle )
        {
          v21 = 424;
LABEL_48:
          IDBG_LINUXAPP_DbgOut(
            130,
            "[%s:%d]Error While loading the libCompUpdateInterface library\n",
            "AMI/AMIDataTransfer.c",
            v21);
          *a3 = -1;
          return FilePath;
        }
        v17 = (int (__fastcall *)(int, int, int *, char *))dlsym(pCUILHandle, "CUIL_GetImageName");
        if ( !v17 || v17(5, 7, &v33, a4) )
        {
LABEL_38:
          *a3 = -1;
          return 1;
        }
        break;
      default:
        FilePath = 1;
        *a3 = 0x80;
        return FilePath;
    }
    return 0;
  }
  return FilePath;
}